#!/bin/bash

echo "Testing HTTP/2 connectivity to server..."

# Test with curl
echo -e "\n=== Testing with curl ==="
curl -kv --http2 https://localhost:5003/ 2>&1 | grep -i "HTTP/2\|Using HTTP2\|SSL\|TLS"

# Test with openssl
echo -e "\n=== Testing TLS handshake with OpenSSL ==="
echo | openssl s_client -connect localhost:5003 -tls1_2 2>&1 | grep -i "SSL\|TLS\|CONNECTED"

# Test with nghttp (if available)
if command -v nghttp &> /dev/null
then
    echo -e "\n=== Testing with nghttp tool ==="
    nghttp -v https://localhost:5003/
else
    echo -e "\n=== nghttp tool not found, skipping this test ==="
    echo "Consider installing nghttp: apt-get install nghttp2-client"
fi

echo -e "\nTests completed!"